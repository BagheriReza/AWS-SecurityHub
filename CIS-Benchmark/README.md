# AWS-CIS-Benchmark
## Introduction 
As I mentioned, I suggest first removing redundant and unnecessary controls and then starting the remediation process. There are different approaches to remediate the Failed controls, using AWS CLI, AWS SDK, AWS Console, fully automated, manually run custom functions, and running script periodically on EC2 instances, lambda function, …. Based on my experience for those who have not have enough experience with AWS, I suggest going through the console to get a better understanding of what are you going to do then based on Failed controls can make a decision how to remediate it. 
For example, if you have just one control failure for CIS 2-7, you can remediate it through console but if you have like hundreds of failed control, it required script and automation to fix it. 
Most of the time, using SDK is much easier and controllable compared with AWS CLI. Therefore I use SDK. On the other hand, most of the repositories which I explore are based on AWS SDK.

As I discovered, there are  four main approaches:
1. Automated Security Response on AWS:
This is a solution offered with AWS which provides a comprehensive solution. The remediation can be used manually or fully automated. ([Automated Security Response Solution](https://aws.amazon.com/solutions/implementations/aws-security-hub-automated-response-and-remediation/))

**Note:** It required a full review of all the solutions and remediation offered by AWS. For example, For CIS 1.3 “ Ensure credentials unused for 90 days or greater are disabled”, based on the solution the key will be disabled. In case, the key is used in production, disabling the key can cause serious problems. So it is recommended to test the remediation on the test environment and understand the side effects of the action then use them. 
Another example can be CIS 2.9 “Ensure VPC flow logging is enabled in all VPCs”, usually the script check is there a flow log or not. In a real scenario, different teams might create different flow logs for different purposes. It means, there is VPC with Flowlogs while the flow logs are created by other teams, not the security team. Therefore, the CIS Control passes but the logs won't be aggregated in the centralized bucket security team which causes a False positive. So we need to check the S3 bucket or cloud watch logs before considering whether the control is passed or failed. 

2. The second solution will be a create the playbook and customize them based on the company's requirements. 
The source of this remediation can be a script offered by AWS in part one, some other source code that exists or we can provide ower own script.
The advantage of this solution is that you create your environment based on your requirements. Sometimes doing customization for part one is more time-consuming than creating your environment.

- Some repositories which I reviewed their scripts:
    - https://github.com/servian/aws-auto-remediate
    - https://github.com/amazon-archives/aws-security-benchmark

3. Batch remediation through EC2:
One good example of this action is disabling redundant controls. Usually, the tasks which take a long time to complete are not recommended to execute by the lambda function (Maximum time per execution time is 15 minutes). So if your organization has hundreds of accounts even more than 20 or 30 accounts it makes sense to execute some batch operations by EC2 instances.
4. Sometimes, in medium or enterprise companies, the information generated by Security Hub is not sufficient to make a decision, so it is needed to generate custom reports to help make management decisions.

Here, I will try to review each control and share my experience with you, for description, audit, and remediation, I will use AWS CIS benchmark documentation.


## Table of contents
- [What's included](#whats-included)
- [Identity and Access Management](#Identity-and-Access-Management)
- [Logging](#Logging)
- [Monitoring](#Monitoring)
- [Networking](#Networking)


## What's included
```
├── ./IAM
├── ./Logging
├── ./Monitoring
├── ./Networking
```

## Identity and Access Management
**CIS 1.1: Avoid the use of the root user**

## Logging
## Monitoring
## Networking